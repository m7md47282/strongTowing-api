@model towing_services.Models.RegisterDriverViewModel


<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">


<style>


    label{
        font-size: 23px !important;
    }

    .btns {
        font-size: 23px !important;
        font-family:Roboto
    }
    .text-danger{
        font-size: 20px !important;
    }
    #areaCode {
        font-size: 23px !important ;
    }
    .form-control {
        font-size: 23px;
    }

 span{
        font-size: 20px;
    }
    /* تحسين المسافات بين الحقول */
    .form-group, .col-md-4 {
        margin-bottom: 20px;
    }


    .container-fluid .x {
        padding:30px
    }
    @@media (max-width: 768px) {
        label

    {
        font-size: 18px !important;
    }

    .btns {
        font-size: 18px !important;
        font-family: Roboto;
    }

    .text-danger {
        font-size: 16px !important;
    }

    #areaCode {
        font-size: 18px !important;
    }

    .form-control {
        font-size: 18px;
    }

    /* تحسين المسافات بين الحقول في الشاشات الصغيرة */
    .form-group, .col-md-4 {
        margin-bottom: 15px;
    }

        .container-fluid .x {
            margin-top: 20px;
            padding: 2px
        }
    }

    @@media (min-width: 769px) {
        label

    {
        font-size: 23px !important;
    }

    .btns {
        font-size: 23px !important;
        font-family: Roboto;
    }

    .text-danger {
        font-size: 20px !important;
    }

    #areaCode {
        font-size: 23px !important;
    }

    .form-control {
        font-size: 23px;
    }

    /* تحسين المسافات بين الحقول في الشاشات الأكبر */
    .form-group, .col-md-4 {
        margin-bottom: 20px;
    }

     
    }
</style>
@{
    var errorMessage = TempData["ErrorMessage"] as string;
}

@if (!string.IsNullOrEmpty(errorMessage))
{
    <div class="alert alert-danger">
        @errorMessage
    </div>
}






<div class="container-fluid x ">

    <div class=" ">
        <div class="">

           
            <div class=" ">
                <form asp-action="AddDriver" method="post" id="addDriverForm" enctype="multipart/form-data">
                    <div class="row g-4">
                        <div class=" col-md-4 mb-3">
                        <label for="Name">Name</label>
                        <input asp-for="Name" class="form-control" />
                        <span class="text-muted">Please choose a unique name for the driver.</span>
                        <span asp-validation-for="Name" class="text-danger"></span>
                    </div>

                        <div class="col-md-4 mb-3">
                        <label for="Phone">Phone</label>
                        <div class="input-group">
                            <!-- اختيار مفتاح الولاية -->
                            <select id="areaCode" class="form-control" required>
                                <option value="+1 (205) ">+1 205 (Alabama)</option>
                                <option value="+1 (907) ">+1 907 (Alaska)</option>
                                <option value="+1 (480) ">+1 480 (Arizona)</option>
                                <option value="+1 (501) ">+1 501 (Arkansas)</option>
                                <option value="+1 (310) ">+1 310 (California)</option>
                                <option value="+1 (303) ">+1 303 (Colorado)</option>
                                <option value="+1 (203) ">+1 203 (Connecticut)</option>
                                <option value="+1 (302) ">+1 302 (Delaware)</option>
                                <option value="+1 (305) ">+1 305 (Florida)</option>
                                <option value="+1 (470) ">+1 470 (Georgia)</option>
                                <option value="+1 (808) ">+1 808 (Hawaii)</option>
                                <option value="+1 (208) ">+1 208 (Idaho)</option>
                                <option value="+1 (312) ">+1 312 (Illinois)</option>
                                <option value="+1 (317) ">+1 317 (Indiana)</option>
                                <option value="+1 (515) ">+1 515 (Iowa)</option>
                                <option value="+1 (913) ">+1 913 (Kansas)</option>
                                <option value="+1 (502) ">+1 502 (Kentucky)</option>
                                <option value="+1 (225) ">+1 225 (Louisiana)</option>
                                <option value="+1 (207) ">+1 207 (Maine)</option>
                                <option value="+1 (301) ">+1 301 (Maryland)</option>
                                <option value="+1 (617) ">+1 617 (Massachusetts)</option>
                                <option value="+1 (231) ">+1 231 (Michigan)</option>
                                <option value="+1 (612) ">+1 612 (Minnesota)</option>
                                <option value="+1 (662) ">+1 662 (Mississippi)</option>
                                <option value="+1 (314) ">+1 314 (Missouri)</option>
                                <option value="+1 (406) ">+1 406 (Montana)</option>
                                <option value="+1 (231) ">+1 231 (Nebraska)</option>
                                <option value="+1 (702) ">+1 702 (Nevada)</option>
                                <option value="+1 (603) ">+1 603 (New Hampshire)</option>
                                <option value="+1 (973) ">+1 973 (New Jersey)</option>
                                <option value="+1 (505) ">+1 505 (New Mexico)</option>
                                <option value="+1 (212) ">+1 212 (New York)</option>
                                <option value="+1 (252) ">+1 252 (North Carolina)</option>
                                <option value="+1 (701) ">+1 701 (North Dakota)</option>
                                <option value="+1 (216) ">+1 216 (Ohio)</option>
                                <option value="+1 (405) ">+1 405 (Oklahoma)</option>
                                <option value="+1 (503) ">+1 503 (Oregon)</option>
                                <option value="+1 (215) ">+1 215 (Pennsylvania)</option>
                                <option value="+1 (401) ">+1 401 (Rhode Island)</option>
                                <option value="+1 (615) ">+1 615 (Tennessee)</option>
                                <option value="+1 (512) ">+1 512 (Texas)</option>
                                <option value="+1 (801) ">+1 801 (Utah)</option>
                                <option value="+1 (802) ">+1 802 (Vermont)</option>
                                <option value="+1 (703) " selected>+1 703 (Virginia)</option>
                                <option value="+1 (206) ">+1 206 (Washington)</option>
                                <option value="+1 (304) ">+1 304 (West Virginia)</option>
                                <option value="+1 (414) ">+1 414 (Wisconsin)</option>
                                <option value="+1 (307) ">+1 307 (Wyoming)</option>

                            </select>
                            <input type="text" id="phoneNumber" name="Phone" class="form-control" placeholder="Enter your phone number" required />
                        </div>
                        <span id="phoneError" class="text-danger"></span>

                        <span asp-validation-for="Phone" class="text-danger"></span>
                        <span class="text-muted">Please choose a unique phone number for the driver.</span> <!-- رسالة توجيهية لرقم الهاتف -->

                    </div>

                        <div class="col-md-4 mb-3">
                        <label for="Email">Email</label>
                        <input asp-for="Email" class="form-control" />

                        <span asp-validation-for="Email" class="text-danger"></span>
                        <span class="text-muted">Please choose a unique email address for the driver.</span> <!-- رسالة توجيهية للبريد الإلكتروني -->

                    </div>
                    </div>


                    <div class="row mt-3">
                      



                        <div class="col-md-4">
                        <label asp-for="ProfilePicture" class="form-label  FF">Profile Picture <span class="text-danger">*</span></label>
                        <input asp-for="ProfilePicture" type="file" class="form-control" accept=".jpg,.jpeg,.png" />
                        <span asp-validation-for="ProfilePicture" class="text-danger"></span>
                    </div>

                        <div class="col-md-4">
                        <label asp-for="LicensePicture" class="form-label FF">License Picture <span class="text-danger">*</span></label>
                        <input asp-for="LicensePicture" type="file" class="form-control" accept=".jpg,.jpeg,.png" />
                        <span asp-validation-for="LicensePicture" class="text-danger"></span>
                    </div>
                        <div class="col-md-4">
                            <label asp-for="WorkPermitPicture" class="form-label FF">Work Permit Picture <span class="text-danger">*</span></label>
                            <input asp-for="WorkPermitPicture" type="file" class="form-control" accept=".jpg,.jpeg,.png" />
                            <span asp-validation-for="WorkPermitPicture" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row mt-3">

                        <div class="col-md-4">
                            <label asp-for="VehicleType" class="control-label">Vehicle Type</label>
                            <select asp-for="VehicleType" class="form-control custom-select" id="VehicleType">

                                <option value="Flatbed">
                                    Flatbed
                                </option>
                                <option value="Heavy Duty">Heavy Duty</option>

                                <option value="Wheel Lift">
                                    Wheel Lift
                                </option>
                            </select>
                        </div>

                    <!-- حقل كلمة المرور -->
                        <div class="col-md-4">
                        <label for="Password">Password</label>
                        <div class="input-group">
                            <input asp-for="Password" type="password" class="form-control" id="Password" />
                            <div class="input-group-append">
                                <span class="input-group-text" id="togglePassword" style="cursor: pointer;">
                                    <i class="fas fa-eye toggleIcon"></i>
                                </span>
                            </div>
                        </div>
                        <span asp-validation-for="Password" class="text-danger"></span>
                        <span class="sp">Password must be at least 8 characters long and contain numbers, letters, and symbols.</span>
                    </div>

                    <!-- حقل تأكيد كلمة المرور -->
                        <div class="col-md-4">
                        <label for="ConfirmPassword">Repeat Your Password</label>
                        <div class="input-group">
                            <input asp-for="ConfirmPassword" type="password" class="form-control" id="ConfirmPassword" />
                            <div class="input-group-append">
                                <span class="input-group-text" id="toggleConfirmPassword" style="cursor: pointer;">
                                    <i class="fas fa-eye toggleIcon"></i>
                                </span>
                            </div>
                        </div>
                        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                    </div>

                    </div>
                    <div class="form-group text-center mt-3">
                        <button type="submit" class="btn btn-primary  btns">ADD DRIVER</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</div>

<div style="padding:70px">
</div>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>

        function togglePasswordsVisibility() {
            // الحقول المستهدفة
            const passwordField = document.getElementById("Password");
            const confirmPasswordField = document.getElementById("ConfirmPassword");
            const icons = document.querySelectorAll(".toggleIcon");

            // تبديل نوع الحقول
            const isPassword = passwordField.type === "password";

            passwordField.type = isPassword ? "text" : "password";
            confirmPasswordField.type = isPassword ? "text" : "password";

            // تبديل الأيقونات لكل الحقول
            icons.forEach(icon => {
                icon.classList.toggle("fa-eye");
                icon.classList.toggle("fa-eye-slash");
            });
        }

           document.addEventListener("DOMContentLoaded", function () {
            const areaCode = document.getElementById("areaCode");
            const phoneNumber = document.getElementById("phoneNumber");
            const form = document.querySelector("form");

            // تعيين مفتاح الدولة الافتراضي عند تحميل الصفحة
            phoneNumber.value = areaCode.value;

            // عند تغيير مفتاح الدولة، يتم تعيين الحقل إلى مفتاح الدولة فقط
            areaCode.addEventListener("change", function () {
                phoneNumber.value = areaCode.value; // تعيين الحقل بمفتاح الدولة الجديد
            });

            // تحديث الرقم عند الكتابة
            phoneNumber.addEventListener("input", function () {
                let currentValue = phoneNumber.value;

                // إذا كانت القيمة فارغة، إعادة مفتاح الدولة فقط
                if (currentValue.trim() === '') {
                    phoneNumber.value = areaCode.value;
                    return;
                }

                const escapedAreaCode = areaCode.value.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");

                // التحقق مما إذا كان رمز الدولة محذوفًا يدويًا
                if (!currentValue.startsWith(areaCode.value)) {
                    // عرض رسالة خطأ بجانب الحقل
                    const errorMessage = document.getElementById('phoneError');
                    if (errorMessage) {
                        errorMessage.textContent = 'It should be entered with the country code.';
                        errorMessage.style.display = 'block';
                    } else {
                        const errorElement = document.createElement('div');
                        errorElement.id = 'phoneError';
                        errorElement.textContent = 'It should be entered with the country code.';
                        errorElement.style.color = 'red';
                        errorElement.style.marginTop = '5px';
                        errorElement.style.fontSize = '0.9em';
                        phoneNumber.parentElement.appendChild(errorElement);
                    }

                    phoneNumber.value = areaCode.value; // إعادة رمز الدولة فقط
                    return;
                }

                // إزالة أي تكرارات لمفتاح الدولة في النص الحالي، مع الحفاظ على التنسيق
                let sanitizedValue = currentValue.replace(new RegExp(`^(\\+?${escapedAreaCode}\\s*)+`), `${escapedAreaCode} `);

                // تنظيف الرقم مع الحفاظ على التنسيق (+، الأقواس، والمسافات)
                sanitizedValue = sanitizedValue.replace(/[^+\d()\s]/g, '');

                // إخفاء رسالة الخطأ إذا كان الإدخال صحيحًا
                const errorMessage = document.getElementById('phoneError');
                if (errorMessage) {
                    errorMessage.style.display = 'none';
                }

                // تحديث حقل رقم الهاتف بالقيمة المعالجة
                phoneNumber.value = sanitizedValue;
            });

            // التأكد من وجود مفتاح الدولة عند فقدان التركيز
            phoneNumber.addEventListener("focusout", function () {
                if (phoneNumber.value.trim() === '' || phoneNumber.value === areaCode.value) {
                    phoneNumber.value = areaCode.value; // إعادة مفتاح الدولة فقط إذا كان الحقل فارغًا
                }
            });

            // التحقق من صحة النموذج قبل الإرسال
            form.addEventListener("submit", function (event) {
                const errorMessage = document.getElementById('phoneError');
                if (phoneNumber.value.trim() === areaCode.value || phoneNumber.value.trim().length <= areaCode.value.length) {
                    event.preventDefault(); // منع إرسال النموذج
                    if (errorMessage) {
                            errorMessage.textContent = 'It should be entered  the Phone number';
                        errorMessage.style.display = 'block';
                    }
                    phoneNumber.focus(); // التركيز على حقل رقم الهاتف
                } else if (errorMessage) {
                    errorMessage.style.display = 'none'; // إخفاء رسالة الخطأ إذا كان الإدخال صحيحًا
                }
            });
        });





    </script>
}
